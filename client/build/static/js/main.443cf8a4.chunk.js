(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{153:function(e,t){},167:function(e,t,n){},172:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(24),o=n.n(s),c=n(64),i=n(35),u=n(20),l=n(3),m=n(11),h={API_URL:"https://yac-backend.herokuapp.com",SOCKET_URL:"https://yac-backend.herokuapp.com"},d="ERROR",p="LOGIN_USER",f="LOGOUT_USER",g="LIST_USERS",b="ADD_USER",y="REMOVE_USER",E="SEND_MESSAGE",v="ADD_MESSAGE",k="UPDATE_MESSAGE",O="REMOVE_MESSAGE",j="GET_MESSAGES";var C=function(){return function(e){fetch("".concat(h.API_URL,"/messages"),{headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){t.error?e({type:d,error:t.error}):(e({type:d,error:""}),e({type:j,messages:t}))})}};var S=n(8),w=n(9),_=n(12),D=n(10),I=n(5),U=n(13),M=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(_.a)(this,Object(D.a)(t).call(this,e))).state={nickname:""},n.handleSubmit=n.handleSubmit.bind(Object(I.a)(n)),n.handleChange=n.handleChange.bind(Object(I.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(I.a)(n)),n}return Object(U.a)(t,e),Object(w.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.nickname&&this.props.onLogin(this.state.nickname.toLowerCase()),this.setState({nickname:""})}},{key:"handleChange",value:function(e){this.setState({nickname:e.target.value})}},{key:"handleKeyDown",value:function(e){32===e.keyCode&&e.preventDefault()}},{key:"render",value:function(){return this.props.user.isLogIn?r.a.createElement(u.a,{to:"/chat"}):r.a.createElement(l.Card,{className:"indigo",textClassName:"white-text",title:"MeltStudio Chat"},r.a.createElement(l.Row,null,r.a.createElement(l.Col,null,r.a.createElement("p",null,"\xa1Hola! Bienvenido a nuestro chat, para empezar solo debes ingresar tu nombre con el cual podremos identificarte.")),r.a.createElement(l.Col,{s:12},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(l.Col,{s:6,offset:"s2"},r.a.createElement(l.TextInput,{s:12,value:this.state.nickname,inputClassName:"white-text",label:"Tu nombre...",onChange:this.handleChange,onKeyDown:this.handleKeyDown})),r.a.createElement(l.Col,{s:2},r.a.createElement(l.Button,{s:12,large:!0,type:"submit",waves:"light",className:"green accent-4"},"Entrar")))),r.a.createElement(l.Col,null,r.a.createElement("p",{className:"white red-text"},this.props.error))))}}]),t}(r.a.Component),L=Object(m.b)(function(e){return{user:e.user,error:e.error}},function(e){return{onLogin:function(t){var n;e((n={nickname:t,isLogIn:!0},function(e){fetch("".concat(h.API_URL,"/auth"),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){t.error?e({type:d,error:t.error}):(e({type:d,error:""}),e({type:p,nickname:t.nickname,isLogIn:t.isLogIn}))})}))}}})(M),R=n(67),N=n.n(R),A=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(_.a)(this,Object(D.a)(t).call(this,e))).state={message:{user:"",body:"",date:"",youtube:""},error:""},n.handleSubmit=n.handleSubmit.bind(Object(I.a)(n)),n.handleChange=n.handleChange.bind(Object(I.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(I.a)(n)),n}return Object(U.a)(t,e),Object(w.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.message.body.length<=140?(this.props.sendMessage(this.state.message),this.props.socket.emit("sending message...",this.state.message),this.setState({message:{body:"",user:"",date:"",youtube:""}})):this.setState({error:"El mensaje es muy largo, por favor reduce la cantidad de caracteres"})}},{key:"handleChange",value:function(e){this.setState({message:{body:e.target.value,user:this.props.user.nickname,date:"",youtube:""}})}},{key:"handleKeyDown",value:function(e){""===this.state.message.body&&32===e.keyCode?e.preventDefault():this.state.message.body.endsWith(" ")&&32===e.keyCode&&e.preventDefault()}},{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(l.Col,{s:10},r.a.createElement(l.Textarea,{validate:!0,error:this.state.error,success:this.props.searchFailed,onChange:this.handleChange,onKeyDown:this.handleKeyDown,s:12,label:"Escribe un mensaje...","data-length":140,value:this.state.message.body})),r.a.createElement(l.Col,{s:2},r.a.createElement(l.Button,{s:12,large:!0,type:"submit",waves:"light",className:"green accent-4"},"ENVIAR")))}}]),t}(r.a.Component),T=Object(m.b)(function(e){return{user:e.user,messages:e.messages,error:e.error}},function(e){return{sendMessage:function(t){e(function(e){return e.date=(new Date).toISOString(),{type:E,message:e}}(t))}}})(A),K=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(_.a)(this,Object(D.a)(t).call(this,e))).handleClick=n.handleClick.bind(Object(I.a)(n)),n}return Object(U.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){this.props.getUsers()}},{key:"handleClick",value:function(e){e.preventDefault(),this.props.socket.emit("good bye",this.props.user),this.props.logoutUser(this.props.user),this.props.socket.close()}},{key:"render",value:function(){var e=this;return this.props.user.isLogIn?r.a.createElement(l.Collection,{header:"Usuarios"},this.props.users.map(function(t){return e.props.user.nickname===t.nickname?r.a.createElement(l.CollectionItem,{key:t.nickname},t.nickname,r.a.createElement("a",{href:"#",onClick:e.handleClick,className:"secondary-content"},r.a.createElement(l.Icon,null,"power_settings_new"))):r.a.createElement(l.CollectionItem,{key:t.nickname},t.nickname)})):r.a.createElement(u.a,{to:"/"})}}]),t}(r.a.Component),x=Object(m.b)(function(e){return{user:e.user,users:e.users,error:e.error}},function(e){return{getUsers:function(){e(function(e){fetch("".concat(h.API_URL,"/users"),{headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){t.error?e({type:d,error:t.error}):(e({type:d,error:""}),e({type:g,users:t}))})})},logoutUser:function(t){e(function(e){return function(t){fetch("".concat(h.API_URL,"/logout"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){e.error?t({type:d,error:e.error}):(t({type:d,error:""}),t({type:f,nickname:"",isLogIn:!1}))})}}(t))}}})(K),G=n(68),P=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(_.a)(this,Object(D.a)(t).call(this,e))).state={date:""},n.formatDate=n.formatDate.bind(Object(I.a)(n)),n}return Object(U.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){this.formatDate()}},{key:"formatDate",value:function(){var e=new Date(this.props.date),t=new Intl.DateTimeFormat("es-CO",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}).format(e);this.setState({date:t})}},{key:"render",value:function(){return r.a.createElement("div",{className:"chat__messages__message"},r.a.createElement("div",{className:"chat__messages__message__up"},r.a.createElement("h6",null,this.props.user),r.a.createElement("small",null,this.state.date)),r.a.createElement("div",{className:"chat__messages__message__down"},this.props.youtube?r.a.createElement(G.a,{videoId:this.props.youtube,opts:{width:400,height:250}}):this.props.body))}}]),t}(r.a.Component),B=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(_.a)(this,Object(D.a)(t).call(this,e))).scrollDown=n.scrollDown.bind(Object(I.a)(n)),n}return Object(U.a)(t,e),Object(w.a)(t,[{key:"scrollDown",value:function(){var e=document.querySelector(".chat__messages");e.scrollTop=e.scrollHeight}},{key:"componentDidMount",value:function(){this.scrollDown()}},{key:"componentDidUpdate",value:function(){this.scrollDown()}},{key:"render",value:function(){return r.a.createElement(l.Row,null,this.props.messages.map(function(e,t){return r.a.createElement(l.Col,{s:9,key:t},r.a.createElement(P,e))}))}}]),t}(r.a.Component),J=Object(m.b)(function(e){return{user:e.user,messages:e.messages,error:e.error}},function(e){return{getMessages:function(){e(C())}}})(B),F=(n(167),function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(_.a)(this,Object(D.a)(t).call(this,e))).state={endpoint:h.SOCKET_URL,socket:null,fail:null},n}return Object(U.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=N()(this.state.endpoint);this.props.getMessages(),t.emit("i am here",this.props.user),t.on("user connected",function(t){e.props.addUser(t)}),t.on("user disconnected",function(t){e.props.removeUser(t)}),t.on("new message",function(t){e.props.addMessage(t)}),t.on("update message",function(t){e.props.updateMessage(t)}),t.on("an error has ocurred",function(t){e.setState({fail:t}),e.props.removeMessage()}),this.setState({socket:t})}},{key:"render",value:function(){return r.a.createElement(l.Row,{className:"chat"},r.a.createElement(l.Col,{s:9,className:"grey lighten-5 chat__messages"},r.a.createElement(J,null)),r.a.createElement(l.Col,{s:3,className:"grey lighten-3 chat__users"},r.a.createElement(x,{socket:this.state.socket})),r.a.createElement(l.Col,{s:12,className:"chat__form"},r.a.createElement(T,{socket:this.state.socket,searchFailed:this.state.fail})))}}]),t}(r.a.Component)),V=Object(m.b)(function(e){return e},function(e){return{addUser:function(t){e(function(e){return{type:b,user:e}}(t))},removeUser:function(t){e(function(e){return{type:y,user:e}}(t))},addMessage:function(t){e(function(e){return{type:v,message:e}}(t))},getMessages:function(){e(C())},updateMessage:function(t){e(function(e){return{type:k,message:e}}(t))},removeMessage:function(){e({type:O})}}})(F);var H=function(){return r.a.createElement(l.Row,null,r.a.createElement(i.a,null,r.a.createElement(l.Col,{s:6,offset:"s3"},r.a.createElement(u.b,{path:"/",exact:!0,component:L})),r.a.createElement(l.Col,{s:12,className:"chat-container"},r.a.createElement(u.b,{path:"/chat",exact:!0,component:V}))))},q=n(16),z=n(47),W=n(71),Q=n.n(W),X=n(72),Y=n(26);var Z=Object(q.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{nickname:"",isLogIn:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:case f:return Object.assign({},e,{nickname:t.nickname,isLogIn:t.isLogIn});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Array.from(t.users);case b:return e.find(function(e){return e.nickname===t.user.nickname})?Object(Y.a)(e):[].concat(Object(Y.a)(e),[t.user]);case y:return e.filter(function(e){return e.nickname!==t.user.nickname});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:case v:return[].concat(Object(Y.a)(e),[t.message]);case k:return e.map(function(e){return e.body===t.message.body&&e.date===t.message.date&&(e.youtube=t.message.youtube),e});case O:var n=Array.from(e);return n.pop(),n;case j:return Array.from(t.messages);default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return t.error;default:return e}}}),$={key:"root",storage:Q.a},ee=Object(z.a)($,Z),te=(n(170),n(171),function(){var e=Object(q.d)(ee,Object(q.a)(X.a));return{store:e,persistor:Object(z.b)(e)}}()),ne=te.store,ae=te.persistor;o.a.render(r.a.createElement(m.a,{store:ne},r.a.createElement(c.a,{loading:null,persistor:ae},r.a.createElement(H,null))),document.getElementById("root"))},73:function(e,t,n){e.exports=n(172)}},[[73,1,2]]]);
//# sourceMappingURL=main.443cf8a4.chunk.js.map